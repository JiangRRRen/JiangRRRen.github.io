<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>SLAM基础2-三维刚体运动 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="1. 旋转矩阵1.1 向量积质点在空间中可由 $xyz$ 坐标确定，但如果考虑刚体，需要考虑姿态问题。 点积$\mathbf {a  \cdot b}&#x3D;x_1x_2+y_1y_2+z_1z_2$，表示两个向量在同一方向的乘积。叉积表示垂直于两个方向的积。$$\mathbf{a\times b}&#x3D;\begin{bmatrix}    \mathbf{i}    &amp;    \mathbf{j}">
<meta property="og:type" content="article">
<meta property="og:title" content="SLAM基础2-三维刚体运动">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2019&#x2F;12&#x2F;16&#x2F;SLAM%E5%9F%BA%E7%A1%802-%E4%B8%89%E7%BB%B4%E5%88%9A%E4%BD%93%E8%BF%90%E5%8A%A8&#x2F;index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="1. 旋转矩阵1.1 向量积质点在空间中可由 $xyz$ 坐标确定，但如果考虑刚体，需要考虑姿态问题。 点积$\mathbf {a  \cdot b}&#x3D;x_1x_2+y_1y_2+z_1z_2$，表示两个向量在同一方向的乘积。叉积表示垂直于两个方向的积。$$\mathbf{a\times b}&#x3D;\begin{bmatrix}    \mathbf{i}    &amp;    \mathbf{j}">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https:&#x2F;&#x2F;bucket-1259555870.cos.ap-chengdu.myqcloud.com&#x2F;20190805152337.png">
<meta property="article:published_time" content="2019-12-16T15:39:12.000Z">
<meta property="article:modified_time" content="2019-12-18T15:10:46.124Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https:&#x2F;&#x2F;bucket-1259555870.cos.ap-chengdu.myqcloud.com&#x2F;20190805152337.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.1.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-SLAM基础2-三维刚体运动" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/16/SLAM%E5%9F%BA%E7%A1%802-%E4%B8%89%E7%BB%B4%E5%88%9A%E4%BD%93%E8%BF%90%E5%8A%A8/" class="article-date">
  <time datetime="2019-12-16T15:39:12.000Z" itemprop="datePublished">2019-12-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      SLAM基础2-三维刚体运动
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="1-旋转矩阵"><a href="#1-旋转矩阵" class="headerlink" title="1. 旋转矩阵"></a>1. 旋转矩阵</h1><h2 id="1-1-向量积"><a href="#1-1-向量积" class="headerlink" title="1.1 向量积"></a>1.1 向量积</h2><p>质点在空间中可由 $xyz$ 坐标确定，但如果考虑<strong>刚体</strong>，需要考虑姿态问题。</p>
<p>点积$\mathbf {a  \cdot b}=x_1x_2+y_1y_2+z_1z_2$，表示两个向量在同一方向的乘积。叉积表示垂直于两个方向的积。<br>$$<br>\mathbf{a\times b}=\begin{bmatrix}<br>    \mathbf{i}    &amp;    \mathbf{j}    &amp;    \mathbf{k}\<br>    x_1    &amp;    y_1    &amp;    z_1\<br>    x_2    &amp;    y_2    &amp;    z_2<br>\end{bmatrix}<br>$$<br>点积可以描述向量间的投影关系。叉积可以表示向量的旋转。对于外积，我们引入了 $∧$符号，把 a 写成一个矩阵。事实上是一个反<strong>对称矩阵 （Skew-symmetric）</strong>，可以将 $∧$ 记成一个反对称符号。这样就把外积 $a×b$，写成了矩阵与向量的乘法 $a∧b$，把它<strong>变成了线性运算</strong>。<br>$$<br>a \times b=\left[\begin{array}{lll}{i} &amp; {j} &amp; {k} \ {a_{1}} &amp; {a_{2}} &amp; {a_{3}} \ {b_{1}} &amp; {b_{2}} &amp; {b_{3}}\end{array}\right]=\left[\begin{array}{l}{a_{2} b_{3}-a_{3} b_{2}} \ {a_{3} b_{1}-a_{1} b_{3}} \ {a_{1} b_{2}-a_{2} b_{1}}\end{array}\right]=\left[\begin{array}{ccc}{0} &amp; {-a_{3}} &amp; {a_{2}} \ {a_{3}} &amp; {0} &amp; {-a_{1}} \ {-a_{2}} &amp; {a_{1}} &amp; {0}\end{array}\right] b \triangleq a^{\wedge} b<br>$$<br>我们可以<strong>用一个向量来描述三维空间中两个向量的旋转关系</strong>。在右手法则下，我们用<strong>右手的四个指头从 a 转向 b，其大拇指朝向就是旋转向量的方向</strong>，事实上也是 $a×b$ 的方向。a 到 b 的旋转可以由向量 $\mathbf{w}$ 来描述。</p>
<img src="https://bucket-1259555870.cos.ap-chengdu.myqcloud.com/20190805152337.png" alt="img" style="zoom:80%;" />

<h2 id="1-2-坐标系的欧氏变换"><a href="#1-2-坐标系的欧氏变换" class="headerlink" title="1.2 坐标系的欧氏变换"></a>1.2 坐标系的欧氏变换</h2><p>我们可以描述<strong>两个坐标系之间的旋转和平移，统称为坐标系之间的变换关系</strong>。欧氏变换则是指<strong>同一个向量在各个坐标系下的长度和夹角都不会发生变化</strong>。比如把手机抛到空中，在它落地摔碎之前，只可能有空间位置和姿态的不同，而它自己的长度、各个面的角度等性质不会有任何变化。</p>
<p>每一个欧氏变换由<strong>旋转</strong>和<strong>平移</strong>组成。</p>
<p>首先考虑<strong>旋转</strong>。我们设某个单位正交基 $(e_1,e_2,e_3)$ 经过一次旋转，变成了  $(e_1’ ,e_2’,e_3’)$ 。那么，对于同一个向量 $\mathbf{a}$（注意该向量并没有 随着坐标系的旋转而发生运动，它在两个坐标系下的坐标为 $[a_1,a_2,a_3]^T$ 和 $[a_1’,a_2’,a_3’]^T$。 根据坐标的定义<br>$$<br>\left[e_{1}, e_{2}, e_{3}\right]\left[\begin{array}{c}{a_{1}} \ {a_{2}} \ {a_{3}}\end{array}\right]=\left[\begin{array}{ccc}{e_{1}^{\prime}} &amp; {e_{2}^{\prime}} &amp; {e_{3}^{\prime}}\end{array}\right]\left[\begin{array}{c}{a_{1}^{\prime}} \ {a_{2}^{\prime}} \ {a_{3}^{\prime}}\end{array}\right]<br>$$<br>为了描述两个坐标之间的关系，我们对上面等式左右同时乘$\begin{bmatrix}    e_1^T    \    e_    2^T\    e_3^T \end{bmatrix}$</p>
<p>那么左边的系数变成了单位矩阵。<br>$$<br>\begin{bmatrix} a_1\a_2\a_3\end{bmatrix}<br>=<br>\begin{bmatrix} e_1^T e_1’ &amp; e_1^T e_2’ &amp; e_1^T e_3’\e_2^T e_1’&amp;e_2^T e_2’&amp;e_1^T e_3’\e_3^T e_1’&amp;e_3^T e_2’&amp;e_3^T e_3’\end{bmatrix}<br>\begin{bmatrix} a_1’\a_2’\a_3’\end{bmatrix}<br>=Ra’<br>$$<br>我们把中间的阵拿出来，定义成一个矩阵 $R$ ，这个矩阵由两组基之间的内积组成，刻画了旋转前后同一个向量的坐标变换关系。只要旋转是一样的，那么 这个矩阵也是一样的， $R$ 就是<strong>旋转矩阵</strong></p>
<p><strong>旋转矩阵是一个行列式为 1 的正交矩阵（orthogonal matrix）</strong>。反之，行列式为1的正交矩阵也是一个旋转矩阵。</p>
<p>它的逆（即转置）描述了一个相反的旋转。即 $R^T$ 刻画了一个相反的旋转。</p>
<blockquote>
<p>$$<br>Q^{T}=Q^{-1} \Leftrightarrow Q^{T} Q=Q Q^{T}=I<br>$$</p>
<p>正交矩阵的转置和逆矩阵相等，正交矩阵与转置矩阵相乘得到单位矩阵</p>
</blockquote>
<p>然后考虑<strong>平移</strong>。考虑世界坐标系中的向量  $\mathbf{a}$，经过一次旋转（用 $R$ 描述）和一次平移 $t$ 后，得到了 ，那么$\mathbf{a’}$把旋转和平移合到一起，有：<br>$$<br>a^{\prime}=R a+t<br>$$</p>
<h2 id="1-3-变换矩阵与齐次坐标"><a href="#1-3-变换矩阵与齐次坐标" class="headerlink" title="1.3 变换矩阵与齐次坐标"></a>1.3 变换矩阵与齐次坐标</h2><p>我们把<strong>一个三维向量的末尾添加 1，变成了四维向量</strong>，称为齐次坐标。对于这个四维向量，我们可以把旋转和平移写在一个矩阵里面，使得整个关系变成 了线性关系。<strong>矩阵 T 称为变换矩阵</strong>（Transform Matrix）。<br>$$<br>\left[\begin{array}{c}{a^{\prime}} \ {1}\end{array}\right]=\left[\begin{array}{cc}{R} &amp; {t} \ {0^{T}} &amp; {1}\end{array}\right]\left[\begin{array}{l}{a} \ {1}\end{array}\right] \triangleq T\left[\begin{array}{l}{a} \ {1}\end{array}\right]<br>$$</p>
<h1 id="2-旋转向量与欧拉角"><a href="#2-旋转向量与欧拉角" class="headerlink" title="2. 旋转向量与欧拉角"></a>2. 旋转向量与欧拉角</h1><h2 id="2-1-旋转向量"><a href="#2-1-旋转向量" class="headerlink" title="2.1 旋转向量"></a>2.1 旋转向量</h2><p>由旋转矩阵来描述旋转，变换矩阵描述一个六自由度的三维刚体运动，但这样过于冗余。旋转矩阵有九个量，但一次旋转只有三个自由度。变换矩阵用十六个量表达了六自由度的变换。需要使用新的表达方式来精简。</p>
<p>外积可以将两个向量的旋转关系表达为一个向量，即<strong>任意旋转都可以用一个旋转轴和一个旋转角来刻画。</strong>于是，我们可以使用一个向量，其方向与旋转轴一致，而长度等于旋转角（为了更紧凑的表达，旋转轴的长度为旋转角）。这种向量，称为<strong>旋转向量</strong>。这种表示法只需一个三维向量即可描述旋转。同样，对于变换矩阵，我们使用一个旋转向量和一个平移向量即可表达一次变换。这时的维数正好是六维。</p>
<p>假设有一个旋转轴为 $\mathbf{n}$，角度为 $θ$ 的旋转，显然，它对应的旋转向量为 $θ\cdot \mathbf{n}$ 。旋转向量与旋转矩阵的转化方式可以由<strong>罗德里格斯公式</strong>表明：<br>$$<br>\mathbf{R}=\cos\theta \mathbf\cdot \mathbf{I}+(1-\cos\theta)\mathbf{nn^T}+\sin\theta\cdot \mathbf{n} {\land}<br>$$</p>
<h2 id="2-2-欧拉角"><a href="#2-2-欧拉角" class="headerlink" title="2.2 欧拉角"></a>2.2 欧拉角</h2><p>无论是旋转矩阵、旋转向量，虽然它们能描述旋转，但对我们人类是非常不直观的。欧拉角使用三个分离的转角，把一个旋转分解成三次绕不同轴的旋转。</p>
<ol>
<li>绕物体的 Z 轴旋转，得到<strong>偏航角</strong> yaw；</li>
<li><strong>绕旋转之后</strong>的 Y 轴旋转，得到<strong>俯仰角</strong> pitch；</li>
<li><strong>绕旋转之后</strong>的 X 轴旋转，得到<strong>滚转角</strong> roll。</li>
</ol>
<p>这种旋转方式称之为<strong>rpy角</strong>。</p>
<p>欧拉角的一个重大缺点是会碰到著名的万向锁问题（Gimbal Lock)，若第二次旋转90°，则会使得物体与X轴垂直，使得系统丢失了一个自由度。</p>
<p>一般不会在程序中直接使用欧拉角表达姿态，同样不会在滤波或优化中使用欧拉角表达旋转。不过，若想验证自己算法是否有错时，转换成欧拉角能够快速辨认结果的正确与否。</p>
<h1 id="3-四元数"><a href="#3-四元数" class="headerlink" title="3. 四元数"></a>3. 四元数</h1><h2 id="3-1-四元数的定义"><a href="#3-1-四元数的定义" class="headerlink" title="3.1 四元数的定义"></a>3.1 四元数的定义</h2><p>四元数拥有一个实部和三个虚部，可定义为:<br>$$<br>\textbf{q}=q_0+q_1i+q_2j+q_3k<br>$$<br>其中$i,j,k$是四元数的三个虚部，满足关系式：<br>$$<br>\begin{equation}<br>\left{<br>             \begin{array}\<br>             i^2=j^2=k^2=-1 &amp;  \<br>             ij=k, ji=-k &amp;\<br>             jk=i,kj=-i&amp; \<br>             ki=j,ik=-j<br>             \end{array}<br>\right.<br>\end{equation}<br>$$<br>有时候也可以用一个标量和一个矢量来表示四元数：<br>$$<br>\textbf{q}=[s,\textbf{v}],\quad s=q_0\in \mathbb{R},\textbf{v}=[q_1,q_2,q_3]^T\in\mathbb{R}^3<br>$$<br>$s$ 称为四元数的实部，而$v$ 称为它的虚部。如果一个四元数虚部为 0，称之为实四元数。反之，若它的实部为 0，称之为虚四元数。</p>
<p>假设某个旋转是绕单位向量$\textbf{n}=[n_x,n_y,n_z]^T$旋转了$θ$，那么这个旋转就可以用四元数表示为：<br>$$<br>\textbf{q}=[\cos\frac{\theta}{2},n_x\sin\frac{\theta}{2},n_y\sin\frac{\theta}{2},n_z\sin\frac{\theta}{2}]^T<br>$$<br>反之，我们亦可从单位四元数中计算出对应旋转轴与夹角：<br>$$<br>\begin{equation}<br>\left{<br>             \begin{array}\<br>                \theta=2\arccos{q_0}\<br>                [n_x,n_y,n_z]^T=[q_1,q_2,q_3]^T/ \sin\frac{\theta}{2}</p>
<pre><code>\end{array}  </code></pre><p>\right.<br>\end{equation}<br>$$</p>
<h2 id="3-2-四元数旋转"><a href="#3-2-四元数旋转" class="headerlink" title="3.2 四元数旋转"></a>3.2 四元数旋转</h2><p>假设空间有三维点$p=[x,y,z]$，如果绕着轴$\mathbf{n}$以$θ$旋转，则将其表示为四元数形式有：<br>$$<br>p=[0,x,y,z]=[0,\textbf{v}]<br>$$<br>用四元数$q$表示这个旋转：<br>$$<br>q=[\cos\frac{\theta}{2},\textbf{n}\sin\frac{\theta}{2}]<br>$$<br>旋转后$p’$就可以表示为:<br>$$<br>p’=qpq^{-1}<br>$$<br>上面描述了某个点的旋转，下面表示的是<strong>如何由旋转四元数表示旋转矩阵</strong>：<br>$$<br>\mathbf{R} = \left[ {\begin{array}{<em>{20}{c}} {1 - 2q_2^2 - 2q_3^2}&amp;{2{q_1}{q_2} + 2{q_0}{q_3}}&amp;{2{q_1}{q_3} - 2{q_0}{q_2}}\ {2{q_1}{q_2} - 2{q_0}{q_3}}&amp;{1 - 2q_1^2 - 2q_3^2}&amp;{2{q_2}{q_3} + 2{q_0}{q_1}}\ {2{q_1}{q_3} + 2{q_0}{q_2}}&amp;{2{q_2}{q_3} - 2{q_0}{q_1}}&amp;{1 - 2q_1^2 - 2q_2^2} \end{array}} \right]<br>$$<br>反之*</em>旋转轴四元数也可以由旋转矩阵**求取：<br>$$<br>q_{0}=\frac{\sqrt{\operatorname{tr}(R)+1}}{2}, q_{1}=\frac{m_{23}-m_{32}}{4 q_{0}}, q_{2}=\frac{m_{31}-m_{13}}{4 q_{0}}, q_{3}=\frac{m_{12}-m_{21}}{4 q_{0}}<br>$$</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/12/16/SLAM%E5%9F%BA%E7%A1%802-%E4%B8%89%E7%BB%B4%E5%88%9A%E4%BD%93%E8%BF%90%E5%8A%A8/" data-id="ck4o2turw0011u4vy7h3wco48" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/12/17/SLAM%E5%9F%BA%E7%A1%803-%E6%9D%8E%E7%BE%A4%E5%92%8C%E6%9D%8E%E4%BB%A3%E6%95%B0/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          SLAM基础3-李群和李代数
        
      </div>
    </a>
  
  
    <a href="/2019/12/15/Socket%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%8E%9F%E7%90%86/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Socket网络编程原理</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/12/27/CPP%E6%B3%9B%E5%9E%8B%E7%BC%96%E7%A8%8B4-%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0%E6%A8%A1%E6%9D%BF/">CPP泛型编程4-可变参数模板</a>
          </li>
        
          <li>
            <a href="/2019/12/27/CPP%E6%B3%9B%E5%9E%8B%E7%BC%96%E7%A8%8B3-%E9%9D%9E%E7%B1%BB%E5%9E%8B%E7%9A%84%E6%A8%A1%E6%9D%BF%E7%B1%BB%E5%8F%82%E6%95%B0/">CPP泛型编程3-非类型的模板参数</a>
          </li>
        
          <li>
            <a href="/2019/12/27/CPP%E6%B3%9B%E5%9E%8B%E7%BC%96%E7%A8%8B2-%E7%B1%BB%E6%A8%A1%E6%9D%BF/">CPP泛型编程2-类模板</a>
          </li>
        
          <li>
            <a href="/2019/12/27/CPP%E6%B3%9B%E5%9E%8B%E7%BC%96%E7%A8%8B1-%E5%87%BD%E6%95%B0%E6%A8%A1%E6%9D%BF/">CPP泛型编程1-函数模板</a>
          </li>
        
          <li>
            <a href="/2019/12/26/CPP%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%80%BB%E7%BB%934-%E5%B9%B6%E5%8F%91%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1%E5%AE%9E%E4%BE%8B/">CPP多线程总结4-并发数据结构设计实例</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>