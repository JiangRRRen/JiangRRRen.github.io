<!DOCTYPE html>
<html>
<head>
    
<!-- Google Analytics -->
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'true', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<!-- End Google Analytics -->


    

    



    <meta charset="utf-8">
    
    <meta name="google-site-verification" content="google-site-verification=6xKBD4e783W5YvEkBJE-d7v5QxyEqF7MRInlhMNq8YU">
    
    
    
    
    <title>Beego框架学习3-Controller | JR&#39;s Blog | 直挂云帆济沧海</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="计算机网络,go,Beego">
    <meta name="description" content="本章介绍Beego的控制器。">
<meta property="og:type" content="article">
<meta property="og:title" content="Beego框架学习3-Controller">
<meta property="og:url" content="jiangren.work/2020/02/01/Beego%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A03-Controller/">
<meta property="og:site_name" content="JR&#39;s Blog">
<meta property="og:description" content="本章介绍Beego的控制器。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://uk-1259555870.cos.eu-frankfurt.myqcloud.com/20200201114228.png">
<meta property="og:image" content="https://uk-1259555870.cos.eu-frankfurt.myqcloud.com/20200201114740.png">
<meta property="og:image" content="https://uk-1259555870.cos.eu-frankfurt.myqcloud.com/20200203130723.png">
<meta property="og:image" content="https://uk-1259555870.cos.eu-frankfurt.myqcloud.com/20200203130855.png">
<meta property="og:image" content="https://uk-1259555870.cos.eu-frankfurt.myqcloud.com/20200203131217.png">
<meta property="article:published_time" content="2020-02-01T03:06:03.000Z">
<meta property="article:modified_time" content="2020-02-03T13:46:48.000Z">
<meta property="article:author" content="Jiang Ren">
<meta property="article:tag" content="计算机网络">
<meta property="article:tag" content="go">
<meta property="article:tag" content="Beego">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://uk-1259555870.cos.eu-frankfurt.myqcloud.com/20200201114228.png">
    
        <link rel="alternate" type="application/atom+xml" title="JR&#39;s Blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <link rel="stylesheet" href="/css/prism/prism-tomorrow-night.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.1"></head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-list-ul"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/MapleStory.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/fong.jpg" style="max-width: 100%;">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Jiang Ren</h5>
          <a href="mailto:jiangren@whu.edu.cn" title="jiangren@whu.edu.cn" class="mail">jiangren@whu.edu.cn</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives/"  >
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags/"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/JiangRRRen" target="_blank" rel="noopener"  >
                <i class="icon icon-lg icon-github"></i>
                代码
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Beego框架学习3-Controller</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Beego框架学习3-Controller</h1>
        <h5 class="subtitle">
            
                <time datetime="2020-02-01T03:06:03.000Z" itemprop="datePublished" class="page-time">
  2020-02-01
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/go/">go</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#1-参数配置"><span class="post-toc-text">1. 参数配置</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-1-修改默认配置"><span class="post-toc-text">1.1 修改默认配置</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-2-不同级别的配置"><span class="post-toc-text">1.2 不同级别的配置</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#2-路由控制"><span class="post-toc-text">2. 路由控制</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-1-处理函数方式"><span class="post-toc-text">2.1 处理函数方式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-1-1-直接绑定函数"><span class="post-toc-text">2.1.1 直接绑定函数</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-1-2-RESTful路由"><span class="post-toc-text">2.1.2 RESTful路由</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-3-路由方式"><span class="post-toc-text">2.3 路由方式</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#3-获取请求参数"><span class="post-toc-text">3. 获取请求参数</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3-1-默认获取参数的方式"><span class="post-toc-text">3.1 默认获取参数的方式</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3-2-绑定struct方式"><span class="post-toc-text">3.2 绑定struct方式</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3-3-处理Json请求"><span class="post-toc-text">3.3 处理Json请求</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#4-响应请求"><span class="post-toc-text">4. 响应请求</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#4-1-返回json数据"><span class="post-toc-text">4.1 返回json数据</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#4-2-返回XML数据"><span class="post-toc-text">4.2 返回XML数据</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#4-3-返回网页"><span class="post-toc-text">4.3 返回网页</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-Beego框架学习3-Controller"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Beego框架学习3-Controller</h1>
        <div class="post-meta">
            <time class="post-time" title="2020-02-01 11:06:03" datetime="2020-02-01T03:06:03.000Z"  itemprop="datePublished">2020-02-01</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/go/">go</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p>本章介绍Beego的控制器。<a id="more"></a></p>
<h1 id="1-参数配置"><a href="#1-参数配置" class="headerlink" title="1. 参数配置"></a>1. 参数配置</h1><h2 id="1-1-修改默认配置"><a href="#1-1-修改默认配置" class="headerlink" title="1.1 修改默认配置"></a>1.1 修改默认配置</h2><p>beego默认会解析当前应用下的conf/app.conf文件，通过这个文件你可以初始化很多 beego 的默认参数：</p>
<pre><code class="lang-go">appname = firstProject
httpport = 8080
runmode = dev
</code></pre>
<p>也可以在配置文件中配置应用需要用的一些配置信息，例如下面所示的数据库信息：</p>
<pre><code class="lang-go">mysqlUser = &quot;test&quot;
mysqlPass = &quot;asdfg12345&quot;
mysqlIp =&quot;cdb-axt937vt.gz.tencentcdb.com&quot;
mysqlPort=&quot;10059&quot;
mysqlDbname = &quot;test&quot;
</code></pre>
<p>可以通过如下的方式获取设置的配置信息:</p>
<pre><code class="lang-go">m:=beego.AppConfig.String(&quot;mysqlUser&quot;)
n:=beego.AppConfig.String(&quot;mysqlPass&quot;)
</code></pre>
<h2 id="1-2-不同级别的配置"><a href="#1-2-不同级别的配置" class="headerlink" title="1.2 不同级别的配置"></a>1.2 不同级别的配置</h2><p>根据不同的运行环境，产品的配置可能不同。</p>
<p>可以有不同的 Runmode 的配置，默认优先读取 runmode 下的配置信息，例如下面的配置文件，我们可以把配置分成三份，比如dev，prod，test：</p>
<pre><code class="lang-go">appname = beegoDemo
runmode = dev   

[dev]
httpport = 9527
[test]
httpport = 5566
[prod] 
httpport = 8082
</code></pre>
<p>读取不同模式下配置参数的方法是“<strong>模式::配置参数名</strong>”，比如：</p>
<pre><code class="lang-go">beego.AppConfig.String(&quot;dev::mysqluser&quot;)
</code></pre>
<h1 id="2-路由控制"><a href="#2-路由控制" class="headerlink" title="2. 路由控制"></a>2. 路由控制</h1><p>路由指的就是<strong>一个url请求由谁来处理</strong>，我们知道Go的执行过程如下：</p>
<p><img src="https://uk-1259555870.cos.eu-frankfurt.myqcloud.com/20200201114228.png"/></p>
<p>在Beego中默认路由的执行路径是：</p>
<p><img src="https://uk-1259555870.cos.eu-frankfurt.myqcloud.com/20200201114740.png"  style="zoom:75%;display: block; margin: 0px auto; vertical-align: middle;"></p>
<p>在<code>routers</code>包中，我们看到：</p>
<pre><code class="lang-go">package routers

import (
    &quot;beegoDemo/controllers&quot;
    &quot;github.com/astaxie/beego&quot;
)

func init() {
    beego.Router(&quot;/&quot;, &amp;controllers.MainController{})
}
</code></pre>
<p>路由初始化中，我们<strong>通过路由注册函数 <code>beego.Router</code>, 注册了一个<code>MainController{}</code>控制器</strong>。第一个参数是 URL (用户请求的地址)，这里我们注册的是 <code>/</code>，也就是我们访问的不带任何参数的 URL。</p>
<p>在beego设计中，url请求可以由控制器的函数来处理，也可以由一个单独的函数来处理，因此路由设置由两部分组成：<strong>url路由</strong> 和 <strong>处理函数</strong>。beego提供两种设置处理函数的方式:</p>
<ul>
<li><strong>直接绑定一个函数</strong></li>
<li><strong>绑定一个控制器对象</strong> （RESTful方式）</li>
</ul>
<h2 id="2-1-处理函数方式"><a href="#2-1-处理函数方式" class="headerlink" title="2.1 处理函数方式"></a>2.1 处理函数方式</h2><h3 id="2-1-1-直接绑定函数"><a href="#2-1-1-直接绑定函数" class="headerlink" title="2.1.1 直接绑定函数"></a>2.1.1 直接绑定函数</h3><p>这种方式直接将一个url路由和一个函数绑定起来。可以用闭包来表示路由，所以可以在<code>router</code>里面直接写：</p>
<pre><code class="lang-go">beego.Get(&quot;/hel&quot;,func(ctx *context.Context){
    ctx.Output.Body([]byte(&quot;hello world&quot;))
})
</code></pre>
<p>这个函数借用了Beego提供的Get接口，但<strong>利用闭包重写了方法</strong>，输出<code>hello world</code>。</p>
<p>此外还有基本的POST路由：</p>
<pre><code class="lang-go">beego.Post(&quot;/alice&quot;,func(ctx *context.Context){
     ctx.Output.Body([]byte(&quot;bob&quot;))
})
</code></pre>
<p>所有的支持的基础函数如下所示：</p>
<ul>
<li>beego.Get(router, beego.FilterFunc)</li>
<li>beego.Post(router, beego.FilterFunc)</li>
<li>beego.Put(router, beego.FilterFunc)</li>
<li>beego.Head(router, beego.FilterFunc)</li>
<li>beego.Options(router, beego.FilterFunc)</li>
<li>beego.Delete(router, beego.FilterFunc)</li>
<li>beego.Any(router, beego.FilterFunc)</li>
</ul>
<h3 id="2-1-2-RESTful路由"><a href="#2-1-2-RESTful路由" class="headerlink" title="2.1.2 RESTful路由"></a>2.1.2 RESTful路由</h3><p>在beego项目中，<strong>RESTful路由方式就是将url路由跟一个控制器对象绑定</strong>，然后Get请求由控制的Get函数处理，Post请求由Post函数处理，以此类推。</p>
<pre><code class="lang-go">// url: / 的所有http请求方法都由MainController控制器的对应函数处理
beego.Router(&quot;/&quot;, &amp;controllers.MainController{})

// url: /user 的所有http请求方法都由UserController控制器的对应函数处理
beego.Router(&quot;/user&quot;, &amp;controllers.UserController{})
</code></pre>
<p>接下来看一个例子：</p>
<p><strong>（1）在controller中写：</strong></p>
<pre><code class="lang-go">package controllers

import (
    &quot;github.com/astaxie/beego&quot;
)

type HelloController struct {
    beego.Controller 
}

func (hello *HelloController) Get() {
    hello.Ctx.WriteString(&quot;hello go&quot;)
}
</code></pre>
<p>这一步中我们声明了一个控制器 <code>HelloController</code>，内嵌了一个<code>beego.Controller</code>，类似于<strong>继承</strong>的效果。然后为控制器安排了一个方法<code>Get()</code>，输出<code>hello go</code>。</p>
<p><strong>（2）在routers的初始化函数中写：</strong></p>
<pre><code class="lang-go">beego.Router(&quot;/hello&quot;, &amp;controllers.HelloController{})
</code></pre>
<p><code>/hello</code>是URL的一部分，可以通过<code>localhost:8080/hello</code>访问。</p>
<h2 id="2-3-路由方式"><a href="#2-3-路由方式" class="headerlink" title="2.3 路由方式"></a>2.3 路由方式</h2><p>这一部分主要介绍url路由的规则，<strong>以下内容都适用于上面介绍的所有路由设置函数。</strong></p>
<p><strong>（1）固定路由</strong></p>
<p>最常见的方式，固定路由指的是url规则是固定的一个url。</p>
<pre><code class="lang-go">beego.Router(&quot;/user&quot;, &amp;controllers.UserController{})
beego.Router(&quot;/shop/order&quot;, &amp;controllers.OrderController{})
beego.Router(&quot;/shop/comment&quot;, &amp;controllers.CommentController{})
</code></pre>
<p><strong>（2）正则路由</strong></p>
<p>由正则表达式形成的路由，先看一个例子：</p>
<p>首先在controller中定义一个控制器：</p>
<pre><code class="lang-go">type RegExpController struct {
    beego.Controller
}
func (this *RegExpController) Get() {
    this.Ctx.WriteString(fmt.Sprintf(&quot;&lt;p&gt;In RegExp Mode&lt;/p&gt;&quot;))

    id := this.Ctx.Input.Param(&quot;:id&quot;)
    this.Ctx.WriteString(fmt.Sprintf(&quot;id is %s.&lt;br /&gt;&quot;, id))
}
</code></pre>
<p>然后在router注册这个控制器，参数可以由<code>:id</code>传递：</p>
<pre><code class="lang-go">// 正则路由从path中提取参数
beego.Router(&quot;/RegExp1/?:id&quot;, &amp;controllers.RegExpController{})
// 正则表达式匹配数字，+表示匹配1次或多次
beego.Router(&quot;/RegExp2/?:id([0-9]+)&quot;, &amp;controllers.RegExpController{})
//匹配下划线和字符
beego.Router(&quot;/RegExp3/?:id([\\w]+)&quot;, &amp;controllers.RegExpController{})
// http://127.0.0.1:8081/RegExp4/abc123de  (id=123)
beego.Router(&quot;/RegExp4/abc:id([0-9]+)de&quot;, &amp;controllers.RegExpController{})
</code></pre>
<p>键入不同的URL，会出现不同的结果：</p>
<pre><code>键入：localhost:8080/RegExp1/12a
显示：
In RegExp Mode
id is 12a.

键入：localhost:8080/RegExp2/12a
显示：404

键入：localhost:8080/RegExp2/13
显示：
In RegExp Mode
id is 13
</code></pre><p><strong>（3）自动路由</strong></p>
<p>自动路由指的是通过反射获取到控制器的名字和控制器实现的所有函数名字，自动生成url路由。</p>
<p>假设我们编写了一个<code>UserController</code>控制器，为控制器添加了Login和Logout方法，<strong>正常来说，需要在router里面调用<code>beego.Router</code>两次，分别注册，这样非常麻烦</strong>。</p>
<p>如果采用自动路由：</p>
<pre><code class="lang-go">beego.AutoRouter(&amp;controllers.UserController{})
</code></pre>
<p>url自动路由例子:</p>
<pre><code class="lang-go">/user/login   调用 UserController 中的 Login 方法
/user/logout  调用 UserController 中的 Logout 方法
</code></pre>
<h1 id="3-获取请求参数"><a href="#3-获取请求参数" class="headerlink" title="3. 获取请求参数"></a>3. 获取请求参数</h1><p>我们经常需要获取用户传递的数据，包括 Get、POST 等方式的请求，beego里面会自动解析这些数据。</p>
<h2 id="3-1-默认获取参数的方式"><a href="#3-1-默认获取参数的方式" class="headerlink" title="3.1 默认获取参数的方式"></a>3.1 默认获取参数的方式</h2><p><code>beego.Controller</code>基础控制器为我们提供了<strong>GetXXX</strong>序列获取参数的函数, XXX指的就是返回不同的数据类型。</p>
<pre><code class="lang-go">type HelloController struct {
    beego.Controller 
}

func (this *HelloController) Get(){
    id,_:=this.GetInt(&quot;id&quot;)
    username:=this.GetString(&quot;username&quot;,&quot;none&quot;)

    this.Ctx.WriteString(strconv.Itoa(id))
    this.Ctx.WriteString(&quot;   &quot;)
    this.Ctx.WriteString(username)
}
</code></pre>
<p>URL输入<code>localhost:8080/hello?id=1&amp;username=clearlove</code>。不仅能在网页上看到输出，还能通过控制台看到：</p>
<pre><code class="lang-go">2020/02/03 12:03:17.185 [D] [server.go:2802]  |  ::1| 200 | 0s|   match| GET  /hello   r:/hello
</code></pre>
<h2 id="3-2-绑定struct方式"><a href="#3-2-绑定struct方式" class="headerlink" title="3.2 绑定struct方式"></a>3.2 绑定struct方式</h2><p>除了上面一个一个的获取请求参数，针对POST请求的表单数据，beego支持<strong>直接将表单数据绑定到一个struct变量。</strong></p>
<p>上一节的Demo采用的是URL传入参数，这次采用Post表单的形式传入。首先在<code>viewer</code>文件夹下生成一个HTML文件<code>register.html</code>：</p>
<pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;注册&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;form action=&quot;/register&quot; method=&quot;post&quot;&gt;
    &lt;table&gt;
        &lt;tbody&gt;
        &lt;tr&gt;
            &lt;td&gt;用户名&lt;/td&gt;
            &lt;td&gt;
                &lt;input type=&quot;text&quot; name =&quot;Name&quot; value=&quot;&quot;&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;密码&lt;/td&gt;
            &lt;td&gt;
                &lt;input type=&quot;password&quot; name =&quot;Pwd&quot; value=&quot;&quot;&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;
                &lt;input type=&quot;submit&quot; value=&quot;确认&quot;&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;/tbody&gt;
    &lt;/table&gt;
&lt;/form&gt;
&lt;/body&gt;
</code></pre>
<p>然后在控制器中写：</p>
<pre><code class="lang-go">type Users struct {
    Name string
    Pwd  string
}

func (this *RegController) Get(){
    this.TplName=&quot;register.html&quot;
}

func (this *RegController) Post(){
    user:=Users{}
    err := this.ParseForm(&amp;user)
    if err!=nil{
        fmt.Println(&quot;err:&quot;,err)
    }else{
        this.Ctx.WriteString(&quot;我是结构体\n&quot;)
        this.Ctx.WriteString(&quot;Name=&quot;+user.Name+&quot;\nPwd=&quot;+user.Pwd)
    }
}
</code></pre>
<p>这段代码的思路是：首先用户访问<code>localhost:8080/register</code>时，Begoo读取<code>register.html</code>资源。</p>
<p><img src="https://uk-1259555870.cos.eu-frankfurt.myqcloud.com/20200203130723.png"  style="zoom:75%;display: block; margin: 0px auto; vertical-align: middle;"></p>
<p>当用户输入账号密码，点击确认时，触发<code>Post</code>。控制器接收请求，解析到结构体中，然后显示出来。</p>
<p><img src="https://uk-1259555870.cos.eu-frankfurt.myqcloud.com/20200203130855.png"  style="zoom:75%;display: block; margin: 0px auto; vertical-align: middle;"></p>
<hr>
<p>如同Beego框架学习2中提到的，我们还可以使用标签来控制解析：</p>
<p>比如给属性设置别名：</p>
<pre><code class="lang-go">PlayerName string `form:&quot;Name&quot;`
</code></pre>
<p>结果还是没变，因为我们写的就是如此，</p>
<pre><code class="lang-go">this.Ctx.WriteString(&quot;Name=&quot;+user.PlayerName+...)
</code></pre>
<p><img src="https://uk-1259555870.cos.eu-frankfurt.myqcloud.com/20200203131217.png"  style="zoom:75%;display: block; margin: 0px auto; vertical-align: middle;"></p>
<p>同时我们也可以设置不想解析的内容，比如验证码。</p>
<pre><code class="lang-go">
type Users struct {
    Name string 
    Pwd  string
        VerCode string  `form:&quot;-&quot;`  //忽略验证码
}
</code></pre>
<h2 id="3-3-处理Json请求"><a href="#3-3-处理Json请求" class="headerlink" title="3.3 处理Json请求"></a>3.3 处理Json请求</h2><p>有时候会将json请求参数保存在http请求的body里面，所以我们需要解析body的内容。</p>
<p><strong>处理json参数的步骤</strong>：</p>
<ol>
<li>在app.conf配置文件中，添加CopyRequestBody=true</li>
<li>通过this.Ctx.Input.RequestBody获取请求body的内容</li>
<li>通过json.Unmarshal反序列化json字符串，将json参数绑定到struct变量。</li>
</ol>
<pre><code class="lang-go">// 如果json字段跟struct字段名不一样，可以通过json标签设置json字段名
type UserForm struct {
    // 忽略掉Id字段
    Id    int         `json:&quot;-&quot;`
    // json字段名为username
    Name  string      `json:&quot;username&quot;`
    Phone string      
}
</code></pre>
<p>控制器代码:</p>
<pre><code class="lang-go">func (this *UserController) Post() {
    // 定义保存json数据的struct对象
    u := UserForm{}

    // 获取body内容
    body := this.Ctx.Input.RequestBody

    // 反序列json数据，结果保存至u
    if err := json.Unmarshal(body, &amp;u); err == nil {
        // 解析参数失败
    }
}
</code></pre>
<h1 id="4-响应请求"><a href="#4-响应请求" class="headerlink" title="4. 响应请求"></a>4. 响应请求</h1><p>第三章主要描述了如何解析用户的请求，而这一章则是如何返回处理过的请求给用户。</p>
<h2 id="4-1-返回json数据"><a href="#4-1-返回json数据" class="headerlink" title="4.1 返回json数据"></a>4.1 返回json数据</h2><pre><code class="lang-go">// 如果struct字段名跟json字段名不一样，可以使用json标签,指定json字段名
type User struct {
    // - 表示忽略id字段
    Id       int    `json:&quot;-&quot;`
    Username string `json:&quot;name&quot;`
    Phone    string
}

func (this *UserController) Get() {
    // 定义需要返回给客户端的数据
    user := User{1, &quot;tizi365&quot;, &quot;13089818901&quot;}

    // 将需要返回的数据赋值给json字段
    this.Data[&quot;json&quot;] = &amp;user

    // 将this.Data[&quot;json&quot;]的数据，序列化成json字符串，然后返回给客户端
    this.ServeJSON()
}
</code></pre>
<h2 id="4-2-返回XML数据"><a href="#4-2-返回XML数据" class="headerlink" title="4.2 返回XML数据"></a>4.2 返回XML数据</h2><pre><code class="lang-go">// 如果struct字段名跟xml字段名不一样，可以使用xml标签,指定xml字段名
type User struct {
    // - 表示忽略id字段
    Id       int    `xml:&quot;-&quot;`
    Username string `xml:&quot;name&quot;`
    Phone    string
}

func (this *UserController) Get() {
    // 定义需要返回给客户端的数据
    user := User{1, &quot;tizi365&quot;, &quot;13089818901&quot;}

    // 将需要返回的数据赋值给xml字段
    this.Data[&quot;xml&quot;] = &amp;user

    // 将this.Data[&quot;xml&quot;]的数据，序列化成xml字符串，然后返回给客户端
    this.ServeXML()
}
</code></pre>
<h2 id="4-3-返回网页"><a href="#4-3-返回网页" class="headerlink" title="4.3 返回网页"></a>4.3 返回网页</h2><pre><code class="lang-go">func (c *MainController) Get() {
    // 设置模板参数
    c.Data[&quot;Website&quot;] = &quot;123.com&quot;
    c.Data[&quot;Email&quot;] = &quot;asd@demo.com&quot;

    // 需要渲染的模板， beego会渲染这个模板，然后返回结果
    c.TplName = &quot;index.tpl&quot;
}
</code></pre>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        

        
        文章发布地址：<a href="/2020/02/01/Beego%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A03-Controller/" target="_blank" rel="external">jiangren.work/2020/02/01/Beego%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A03-Controller/</a>
        
    </div>
    
    <footer>
        <a href="jiangren.work">
            <img src="/img/fong.jpg" alt="Jiang Ren">
            Jiang Ren
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Beego/" rel="tag">Beego</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/go/" rel="tag">go</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" rel="tag">计算机网络</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=jiangren.work/2020/02/01/Beego%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A03-Controller/&title=《Beego框架学习3-Controller》 — JR's Blog&pic=jiangren.work/img/fong.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=jiangren.work/2020/02/01/Beego%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A03-Controller/&title=《Beego框架学习3-Controller》 — JR's Blog&source=本章介绍Beego的控制器。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=jiangren.work/2020/02/01/Beego%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A03-Controller/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Beego框架学习3-Controller》 — JR's Blog&url=jiangren.work/2020/02/01/Beego%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A03-Controller/&via=jiangren.work" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=jiangren.work/2020/02/01/Beego%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A03-Controller/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2020/02/03/Beego%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A04-Viewer/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Beego框架学习4-Viewer</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2020/01/31/Beego%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A02-Model/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Beego框架学习2-Model</h4>
      </a>
    </div>
  
</nav>



    





















</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        感谢支持！
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/true" alt="打赏二维码">
        </div>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


            <p>
                
                    <span>
                        <a href="/atom.xml" target="_blank" class="rss" title="rss">
                            <i class="icon icon-lg icon-rss"></i>
                        </a>
                    </span>
                    
                        <span>
                            博客内容遵循 <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a>
                        </span>
            </p>
    </div>
    <div class="bottom">
        <p>
            <span>
                Jiang Ren &copy;
                    
                        2019 -
                            
                                2020
            </span>
            <span>
                
                        Power by
                        <a href="http://hexo.io/" target="_blank">Hexo</a> Theme
                        <a href="https://github.com/abelsu7/hexo-theme-indigo-plus" target="_blank">indigo plus</a>
                        <p>Hosted by <a href="https://pages.github.com" target="_blank" style="font-weight: bold">Github Pages</a></p>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>
<a href="javascript:;" id="gobottom" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-comments"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=jiangren.work/2020/02/01/Beego%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A03-Controller/&title=《Beego框架学习3-Controller》 — JR's Blog&pic=jiangren.work/img/fong.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=jiangren.work/2020/02/01/Beego%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A03-Controller/&title=《Beego框架学习3-Controller》 — JR's Blog&source=本章介绍Beego的控制器。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=jiangren.work/2020/02/01/Beego%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A03-Controller/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Beego框架学习3-Controller》 — JR's Blog&url=jiangren.work/2020/02/01/Beego%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A03-Controller/&via=jiangren.work" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=jiangren.work/2020/02/01/Beego%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A03-Controller/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=jiangren.work/2020/02/01/Beego%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A03-Controller/" alt="微信分享二维码">
</div>




    <script src="//cdn.jsdelivr.net/npm/node-waves@0.7.6/src/js/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.7.2" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<script src="/js/prism.min.js?v=1.7.2"></script>
<script src="/js/prism-vim.min.js?v=1.7.2"></script>
</body>
</html>
